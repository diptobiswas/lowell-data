<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Policy Simulator ‚Äî Lowell Data Suite</title>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --cream: #FFFBF5;
      --amber: #F59E0B;
      --amber-light: #FCD34D;
      --coral: #FB7185;
      --green: #10B981;
      --blue: #3B82F6;
      --purple: #8B5CF6;
      --ink: #1C1917;
      --ink-soft: #78716C;
      --ink-muted: #A8A29E;
      --glass: rgba(255, 251, 245, 0.7);
      --glass-border: rgba(245, 158, 11, 0.15);
    }
    
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    body {
      font-family: 'Space Grotesk', system-ui, sans-serif;
      background: var(--cream);
      color: var(--ink);
      min-height: 100vh;
    }
    
    .ambient {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 0;
    }
    .ambient::before {
      content: '';
      position: absolute;
      top: -20%;
      left: -10%;
      width: 600px;
      height: 600px;
      background: radial-gradient(circle, rgba(139,92,246,0.08) 0%, transparent 70%);
    }
    
    .container {
      position: relative;
      z-index: 1;
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 24px;
    }
    
    nav {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 48px;
    }
    nav a {
      padding: 8px 16px;
      border-radius: 100px;
      font-size: 0.85rem;
      font-weight: 500;
      text-decoration: none;
      color: var(--ink-soft);
      transition: all 0.2s;
    }
    nav a:hover { color: var(--ink); background: rgba(0,0,0,0.03); }
    nav a.active { background: var(--ink); color: var(--cream); }
    
    .header { margin-bottom: 40px; }
    .header h1 {
      font-size: 2rem;
      font-weight: 700;
      letter-spacing: -1px;
      margin-bottom: 4px;
    }
    .header p { color: var(--ink-soft); font-size: 0.95rem; }
    
    /* Layout */
    .layout {
      display: grid;
      grid-template-columns: 340px 1fr;
      gap: 32px;
    }
    @media (max-width: 900px) {
      .layout { grid-template-columns: 1fr; }
    }
    
    /* Controls Panel */
    .controls {
      background: var(--glass);
      backdrop-filter: blur(10px);
      border: 1px solid var(--glass-border);
      border-radius: 20px;
      padding: 24px;
      height: fit-content;
      position: sticky;
      top: 24px;
    }
    .controls h2 {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .control-group {
      margin-bottom: 24px;
    }
    .control-label {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    .control-label span:first-child {
      font-size: 0.85rem;
      font-weight: 500;
    }
    .control-value {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--amber);
      min-width: 50px;
      text-align: right;
    }
    
    input[type="range"] {
      width: 100%;
      height: 8px;
      -webkit-appearance: none;
      background: rgba(0,0,0,0.06);
      border-radius: 100px;
      outline: none;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--amber), var(--amber-light));
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(245,158,11,0.3);
      transition: transform 0.2s;
    }
    input[type="range"]::-webkit-slider-thumb:hover {
      transform: scale(1.1);
    }
    
    .reset-btn {
      width: 100%;
      padding: 12px;
      border: 1px solid rgba(0,0,0,0.1);
      border-radius: 10px;
      background: transparent;
      font-family: inherit;
      font-size: 0.85rem;
      font-weight: 500;
      color: var(--ink-soft);
      cursor: pointer;
      transition: all 0.2s;
    }
    .reset-btn:hover {
      background: rgba(0,0,0,0.03);
      color: var(--ink);
    }
    
    /* Results Panel */
    .results { display: flex; flex-direction: column; gap: 24px; }
    
    /* City Health Score */
    .health-score {
      background: var(--glass);
      backdrop-filter: blur(10px);
      border: 1px solid var(--glass-border);
      border-radius: 20px;
      padding: 32px;
      text-align: center;
    }
    .health-score h3 {
      font-size: 0.8rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--ink-muted);
      margin-bottom: 12px;
    }
    .score-value {
      font-size: 4rem;
      font-weight: 700;
      letter-spacing: -2px;
      line-height: 1;
      margin-bottom: 8px;
      transition: color 0.3s;
    }
    .score-value.excellent { color: var(--green); }
    .score-value.good { color: var(--blue); }
    .score-value.moderate { color: var(--amber); }
    .score-value.poor { color: var(--coral); }
    .score-label {
      font-size: 0.9rem;
      color: var(--ink-soft);
    }
    
    /* Projections */
    .projections {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 12px;
    }
    .projection-card {
      background: var(--glass);
      backdrop-filter: blur(10px);
      border: 1px solid var(--glass-border);
      border-radius: 14px;
      padding: 20px 16px;
      text-align: center;
    }
    .projection-card .label {
      font-size: 0.7rem;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--ink-muted);
      margin-bottom: 8px;
    }
    .projection-card .value {
      font-size: 1.4rem;
      font-weight: 700;
      margin-bottom: 4px;
    }
    .projection-card .change {
      font-size: 0.75rem;
      font-weight: 600;
      padding: 2px 8px;
      border-radius: 100px;
      display: inline-block;
    }
    .projection-card .change.up { background: rgba(16,185,129,0.1); color: var(--green); }
    .projection-card .change.down { background: rgba(251,113,133,0.1); color: var(--coral); }
    .projection-card .change.neutral { background: rgba(0,0,0,0.05); color: var(--ink-muted); }
    
    /* Timeline Toggle */
    .timeline-toggle {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
    }
    .timeline-btn {
      flex: 1;
      padding: 10px;
      border: 1px solid rgba(0,0,0,0.1);
      border-radius: 8px;
      background: transparent;
      font-family: inherit;
      font-size: 0.85rem;
      font-weight: 500;
      color: var(--ink-soft);
      cursor: pointer;
      transition: all 0.2s;
    }
    .timeline-btn.active {
      background: var(--ink);
      color: var(--cream);
      border-color: var(--ink);
    }
    
    /* Risks */
    .risks {
      background: var(--glass);
      backdrop-filter: blur(10px);
      border: 1px solid var(--glass-border);
      border-radius: 16px;
      padding: 20px;
    }
    .risks h3 {
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .risk-item {
      padding: 12px 14px;
      border-radius: 10px;
      margin-bottom: 8px;
      font-size: 0.85rem;
      display: flex;
      align-items: flex-start;
      gap: 10px;
    }
    .risk-item:last-child { margin-bottom: 0; }
    .risk-item.high { background: rgba(251,113,133,0.1); color: var(--coral); }
    .risk-item.medium { background: rgba(245,158,11,0.1); color: var(--amber); }
    .risk-item.low { background: rgba(16,185,129,0.1); color: var(--green); }
    .risk-item .icon { font-size: 1rem; }
    
    /* Recommendation */
    .recommendation {
      background: linear-gradient(135deg, rgba(245,158,11,0.1), rgba(251,113,133,0.05));
      border: 1px solid rgba(245,158,11,0.2);
      border-radius: 16px;
      padding: 20px;
    }
    .recommendation h3 {
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 10px;
      color: var(--amber);
    }
    .recommendation p {
      font-size: 0.9rem;
      color: var(--ink-soft);
      line-height: 1.6;
    }
    
    footer {
      margin-top: 64px;
      padding-top: 24px;
      border-top: 1px solid rgba(0,0,0,0.06);
      text-align: center;
      font-size: 0.8rem;
      color: var(--ink-muted);
    }
  </style>
</head>
<body>
  <div class="ambient"></div>
  
  <div class="container">
    <nav>
      <a href="index.html">‚Üê Home</a>
      <a href="dashboard.html">Dashboard</a>
      <a href="correlations.html">Correlations</a>
      <a href="simulator.html" class="active">Simulator</a>
      <a href="maturity-assessment.html">Maturity</a>
    </nav>
    
    <header class="header">
      <h1>Policy Simulator</h1>
      <p>Model scenarios and project 5-10 year impacts on Lowell</p>
    </header>
    
    <div class="layout">
      <aside class="controls">
        <h2>üéõÔ∏è Policy Levers</h2>
        
        <div class="control-group">
          <div class="control-label">
            <span>Housing Incentives</span>
            <span class="control-value" id="housing-value">0%</span>
          </div>
          <input type="range" id="housing" min="-50" max="100" value="0">
        </div>
        
        <div class="control-group">
          <div class="control-label">
            <span>Job Creation Programs</span>
            <span class="control-value" id="jobs-value">0%</span>
          </div>
          <input type="range" id="jobs" min="-50" max="100" value="0">
        </div>
        
        <div class="control-group">
          <div class="control-label">
            <span>Education Investment</span>
            <span class="control-value" id="education-value">0%</span>
          </div>
          <input type="range" id="education" min="-50" max="100" value="0">
        </div>
        
        <div class="control-group">
          <div class="control-label">
            <span>Infrastructure Upgrade</span>
            <span class="control-value" id="infra-value">0%</span>
          </div>
          <input type="range" id="infra" min="-50" max="100" value="0">
        </div>
        
        <div class="control-group">
          <div class="control-label">
            <span>Business Tax Rate</span>
            <span class="control-value" id="tax-value">0%</span>
          </div>
          <input type="range" id="tax" min="-50" max="50" value="0">
        </div>
        
        <button class="reset-btn" onclick="resetControls()">Reset All</button>
      </aside>
      
      <main class="results">
        <div class="health-score">
          <h3>City Health Index</h3>
          <div class="score-value moderate" id="health-score">62</div>
          <div class="score-label" id="health-label">Moderate ‚Äî Room for improvement</div>
        </div>
        
        <div class="timeline-toggle">
          <button class="timeline-btn active" onclick="setTimeline(5)">5-Year</button>
          <button class="timeline-btn" onclick="setTimeline(10)">10-Year</button>
        </div>
        
        <div class="projections" id="projections">
          <div class="projection-card">
            <div class="label">Population</div>
            <div class="value" id="pop-value">114,799</div>
            <span class="change neutral" id="pop-change">‚Üí 0%</span>
          </div>
          <div class="projection-card">
            <div class="label">Median Income</div>
            <div class="value" id="income-value">$76.2K</div>
            <span class="change neutral" id="income-change">‚Üí 0%</span>
          </div>
          <div class="projection-card">
            <div class="label">Poverty Rate</div>
            <div class="value" id="poverty-value">16%</div>
            <span class="change neutral" id="poverty-change">‚Üí 0%</span>
          </div>
          <div class="projection-card">
            <div class="label">Home Value</div>
            <div class="value" id="home-value">$395K</div>
            <span class="change neutral" id="home-change">‚Üí 0%</span>
          </div>
          <div class="projection-card">
            <div class="label">Employment</div>
            <div class="value" id="emp-value">59,001</div>
            <span class="change neutral" id="emp-change">‚Üí 0%</span>
          </div>
          <div class="projection-card">
            <div class="label">Homeownership</div>
            <div class="value" id="own-value">44%</div>
            <span class="change neutral" id="own-change">‚Üí 0%</span>
          </div>
        </div>
        
        <div class="risks" id="risks">
          <h3>‚ö†Ô∏è Risk Assessment</h3>
          <div class="risk-item low">
            <span class="icon">‚úì</span>
            <span>Baseline scenario ‚Äî no major risks identified</span>
          </div>
        </div>
        
        <div class="recommendation" id="recommendation">
          <h3>üí° AI Recommendation</h3>
          <p>Adjust the policy levers to see projected impacts. The simulator uses correlation data to model interconnected effects.</p>
        </div>
      </main>
    </div>
    
    <footer>
      <p>Model based on correlation analysis ¬∑ Not predictive financial advice</p>
    </footer>
  </div>
  
  <script>
    // Baseline values
    const baseline = {
      population: 114799,
      income: 76205,
      poverty: 16,
      homeValue: 395100,
      employment: 59001,
      homeownership: 44
    };
    
    let timeline = 5;
    
    // Get all sliders
    const sliders = {
      housing: document.getElementById('housing'),
      jobs: document.getElementById('jobs'),
      education: document.getElementById('education'),
      infra: document.getElementById('infra'),
      tax: document.getElementById('tax')
    };
    
    // Update display values
    Object.keys(sliders).forEach(key => {
      sliders[key].addEventListener('input', () => {
        document.getElementById(key + '-value').textContent = 
          (sliders[key].value > 0 ? '+' : '') + sliders[key].value + '%';
        updateProjections();
      });
    });
    
    function setTimeline(years) {
      timeline = years;
      document.querySelectorAll('.timeline-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      updateProjections();
    }
    
    function resetControls() {
      Object.values(sliders).forEach(slider => slider.value = 0);
      Object.keys(sliders).forEach(key => {
        document.getElementById(key + '-value').textContent = '0%';
      });
      updateProjections();
    }
    
    function updateProjections() {
      const h = parseInt(sliders.housing.value);
      const j = parseInt(sliders.jobs.value);
      const e = parseInt(sliders.education.value);
      const i = parseInt(sliders.infra.value);
      const t = parseInt(sliders.tax.value);
      
      const multiplier = timeline / 5;
      
      // Calculate changes (interconnected model)
      const popChange = ((j * 0.15 + h * 0.1 + e * 0.05 - t * 0.1) * multiplier);
      const incomeChange = ((j * 0.2 + e * 0.25 + i * 0.1 - t * 0.05) * multiplier);
      const povertyChange = ((-j * 0.15 - e * 0.2 - i * 0.05 + t * 0.1) * multiplier);
      const homeChange = ((h * 0.3 + j * 0.15 + i * 0.2) * multiplier);
      const empChange = ((j * 0.3 - t * 0.2 + e * 0.1 + h * 0.05) * multiplier);
      const ownChange = ((h * 0.2 + j * 0.1 + i * 0.05 - t * 0.05) * multiplier);
      
      // Update values
      updateMetric('pop', baseline.population, popChange, v => Math.round(v).toLocaleString());
      updateMetric('income', baseline.income, incomeChange, v => '$' + (v/1000).toFixed(1) + 'K');
      updateMetric('poverty', baseline.poverty, povertyChange, v => v.toFixed(1) + '%', true);
      updateMetric('home', baseline.homeValue, homeChange, v => '$' + Math.round(v/1000) + 'K');
      updateMetric('emp', baseline.employment, empChange, v => Math.round(v).toLocaleString());
      updateMetric('own', baseline.homeownership, ownChange, v => v.toFixed(1) + '%');
      
      // Calculate health score
      const healthScore = Math.max(0, Math.min(100, 
        62 + (j * 0.15) + (e * 0.2) + (i * 0.1) + (h * 0.1) - (t * 0.1) - Math.abs(povertyChange) * 0.3
      ));
      
      const scoreEl = document.getElementById('health-score');
      const labelEl = document.getElementById('health-label');
      scoreEl.textContent = Math.round(healthScore);
      scoreEl.className = 'score-value ' + getScoreClass(healthScore);
      labelEl.textContent = getScoreLabel(healthScore);
      
      // Update risks
      updateRisks(h, j, e, i, t, popChange, povertyChange);
      
      // Update recommendation
      updateRecommendation(h, j, e, i, t);
    }
    
    function updateMetric(id, base, change, format, invert = false) {
      const newVal = base * (1 + change / 100);
      document.getElementById(id + '-value').textContent = format(newVal);
      
      const changeEl = document.getElementById(id + '-change');
      const displayChange = invert ? -change : change;
      
      if (Math.abs(change) < 0.5) {
        changeEl.textContent = '‚Üí 0%';
        changeEl.className = 'change neutral';
      } else if (displayChange > 0) {
        changeEl.textContent = '‚Üë ' + Math.abs(change).toFixed(1) + '%';
        changeEl.className = 'change up';
      } else {
        changeEl.textContent = '‚Üì ' + Math.abs(change).toFixed(1) + '%';
        changeEl.className = 'change down';
      }
    }
    
    function getScoreClass(score) {
      if (score >= 80) return 'excellent';
      if (score >= 65) return 'good';
      if (score >= 45) return 'moderate';
      return 'poor';
    }
    
    function getScoreLabel(score) {
      if (score >= 80) return 'Excellent ‚Äî Thriving city';
      if (score >= 65) return 'Good ‚Äî Positive trajectory';
      if (score >= 45) return 'Moderate ‚Äî Room for improvement';
      return 'Poor ‚Äî Significant challenges';
    }
    
    function updateRisks(h, j, e, i, t, popChange, povertyChange) {
      const risks = [];
      
      if (popChange < -5) {
        risks.push({ level: 'high', text: 'Brain drain risk ‚Äî population declining significantly' });
      }
      if (t > 30) {
        risks.push({ level: 'high', text: 'Business flight risk ‚Äî high tax burden' });
      }
      if (h < -20 && i < -20) {
        risks.push({ level: 'high', text: 'Infrastructure decay ‚Äî deferred maintenance compounds' });
      }
      if (povertyChange > 3) {
        risks.push({ level: 'medium', text: 'Rising inequality ‚Äî poverty rate increasing' });
      }
      if (j < -20) {
        risks.push({ level: 'medium', text: 'Employment contraction ‚Äî job losses accelerating' });
      }
      if (e < -20) {
        risks.push({ level: 'medium', text: 'Education gap ‚Äî reduced investment affects outcomes' });
      }
      
      if (risks.length === 0) {
        risks.push({ level: 'low', text: 'No major risks identified in current scenario' });
      }
      
      const risksHtml = risks.map(r => `
        <div class="risk-item ${r.level}">
          <span class="icon">${r.level === 'low' ? '‚úì' : '‚ö†'}</span>
          <span>${r.text}</span>
        </div>
      `).join('');
      
      document.getElementById('risks').innerHTML = '<h3>‚ö†Ô∏è Risk Assessment</h3>' + risksHtml;
    }
    
    function updateRecommendation(h, j, e, i, t) {
      let rec = '';
      
      const total = h + j + e + i;
      
      if (total === 0 && t === 0) {
        rec = 'Adjust the policy levers to see projected impacts. The simulator models interconnected effects based on correlation data.';
      } else if (total > 150) {
        rec = 'Ambitious plan! Consider phasing investments to manage budget constraints. Prioritize education and jobs for highest ROI.';
      } else if (j > 50 && e > 30) {
        rec = 'Strong combo: job creation + education investment creates a talent retention flywheel. This addresses the brain drain problem.';
      } else if (h > 50 && i > 30) {
        rec = 'Infrastructure-housing combo targets the 42.7% pre-1939 housing problem. Consider pairing with lead abatement programs.';
      } else if (t > 20) {
        rec = 'Caution: high business taxes historically correlate with job losses in gateway cities. Consider balancing with incentives.';
      } else if (t < -20) {
        rec = 'Tax cuts may attract business but monitor revenue impact on services. Pair with efficiency improvements.';
      } else {
        rec = 'Balanced approach. For maximum impact, research suggests focusing on education + job creation for economic mobility.';
      }
      
      document.getElementById('recommendation').innerHTML = `
        <h3>üí° AI Recommendation</h3>
        <p>${rec}</p>
      `;
    }
    
    // Initialize
    updateProjections();
  </script>
</body>
</html>
